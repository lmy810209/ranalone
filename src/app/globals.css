@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    --background: 0 0% 2%;          /* #050505 — void black */
    --foreground: 120 5% 88%;       /* slightly green-tinged white */

    --card: 0 0% 5%;
    --card-foreground: 120 5% 88%;

    --popover: 0 0% 5%;
    --popover-foreground: 120 5% 88%;

    --primary: 120 14% 49%;         /* #6b8f6b — muted terminal green */
    --primary-foreground: 120 25% 10%;

    --secondary: 0 0% 10%;
    --secondary-foreground: 120 5% 88%;

    --muted: 0 0% 10%;
    --muted-foreground: 120 8% 45%;

    --accent: 43 93% 54%;           /* amber — keep for ALERT elements */
    --accent-foreground: 43 25% 10%;

    --destructive: 0 72% 32%;
    --destructive-foreground: 0 0% 98%;

    --border: 120 5% 12%;
    --input: 120 5% 12%;
    --ring: 120 14% 49%;

    --radius: 0.5rem;

    --sidebar-background: 0 0% 2%;
    --sidebar-foreground: 120 5% 88%;
    --sidebar-primary: 120 14% 49%;
    --sidebar-primary-foreground: 120 25% 10%;
    --sidebar-accent: 0 0% 10%;
    --sidebar-accent-foreground: 120 5% 88%;
    --sidebar-border: 120 5% 12%;
    --sidebar-ring: 120 14% 49%;
  }

  .dark {
    --background: 0 0% 2%;
    --foreground: 120 5% 88%;
    --card: 0 0% 5%;
    --card-foreground: 120 5% 88%;
    --popover: 0 0% 5%;
    --popover-foreground: 120 5% 88%;
    --primary: 120 14% 49%;
    --primary-foreground: 120 25% 10%;
    --secondary: 0 0% 10%;
    --secondary-foreground: 120 5% 88%;
    --muted: 0 0% 10%;
    --muted-foreground: 120 8% 45%;
    --accent: 43 93% 54%;
    --accent-foreground: 43 25% 10%;
    --destructive: 0 72% 32%;
    --destructive-foreground: 0 0% 98%;
    --border: 120 5% 12%;
    --input: 120 5% 12%;
    --ring: 120 14% 49%;

    --sidebar-background: 0 0% 2%;
    --sidebar-foreground: 120 5% 88%;
    --sidebar-primary: 120 14% 49%;
    --sidebar-primary-foreground: 120 25% 10%;
    --sidebar-accent: 0 0% 10%;
    --sidebar-accent-foreground: 120 5% 88%;
    --sidebar-border: 120 5% 12%;
    --sidebar-ring: 120 14% 49%;
  }
}

@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground;
  }
}

/* ── Noise / static texture overlay ───────────────────────────────────── */

body::before {
  content: '';
  position: fixed;
  inset: 0;
  z-index: 9989;
  pointer-events: none;
  opacity: 0.025;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
  background-size: 180px 180px;
  animation: noise-shift 0.65s steps(2) infinite;
}

@keyframes noise-shift {
  0%   { background-position: 0 0; }
  25%  { background-position: 40px 60px; }
  50%  { background-position: -30px 80px; }
  75%  { background-position: 70px -40px; }
  100% { background-position: -50px 30px; }
}

/* ── Scanline overlay ──────────────────────────────────────────────────── */

body::after {
  content: '';
  position: fixed;
  inset: 0;
  background: repeating-linear-gradient(
    0deg,
    transparent,
    transparent 2px,
    rgba(0, 0, 0, 0.028) 2px,
    rgba(0, 0, 0, 0.028) 4px
  );
  pointer-events: none;
  z-index: 9990;
}

/* ── Keyframe animations ───────────────────────────────────────────────── */

/* Glitch: text displacement effect */
@keyframes glitch {
  0%, 88%, 96%, 100% {
    transform: translate(0);
    text-shadow: none;
    opacity: 1;
  }
  89% {
    transform: translate(-2px, 0);
    text-shadow: 2px 0 rgba(255, 30, 30, 0.85);
    opacity: 0.9;
  }
  90% {
    transform: translate(2px, 0);
    text-shadow: -2px 0 rgba(0, 200, 200, 0.7);
    opacity: 0.9;
  }
  91% {
    transform: translate(0);
    opacity: 0.2;
  }
  92% {
    transform: translate(-1px, 1px);
    text-shadow: 1px 0 rgba(255, 0, 0, 0.5);
    opacity: 1;
  }
  93%, 95% {
    transform: translate(0);
    text-shadow: none;
    opacity: 1;
  }
  94% {
    opacity: 0;
  }
}

/* Slow red pulse for header background */
@keyframes red-pulse {
  0%, 100% {
    box-shadow: inset 0 0 60px rgba(120, 0, 0, 0);
  }
  50% {
    box-shadow: inset 0 0 60px rgba(120, 0, 0, 0.09);
  }
}

/* Observer count number flicker */
@keyframes count-tick {
  0%, 90%, 100% { opacity: 1; }
  95% { opacity: 0.4; }
}

/* Subtle text jitter on hover */
@keyframes text-jitter {
  0%, 100% { transform: translate(0, 0); }
  10%       { transform: translate(-0.4px, 0.3px); }
  20%       { transform: translate(0.3px, -0.3px); }
  30%       { transform: translate(-0.3px, 0.2px); }
  40%       { transform: translate(0.5px, -0.2px); }
  50%       { transform: translate(-0.2px, 0.4px); }
  60%       { transform: translate(0.3px, 0.2px); }
  70%       { transform: translate(-0.4px, -0.3px); }
  80%       { transform: translate(0.2px, 0.2px); }
  90%       { transform: translate(-0.2px, 0); }
}

/* Status indicator pulse */
@keyframes status-pulse {
  0%, 100% { opacity: 1; box-shadow: 0 0 0 0 currentColor; }
  50%       { opacity: 0.5; }
}

/* Red border flash on card hover */
@keyframes border-flash-red {
  0%   { border-color: hsl(var(--border)); box-shadow: none; }
  8%   { border-color: rgba(210, 30, 30, 0.95); box-shadow: 0 0 14px rgba(210, 30, 30, 0.45), inset 0 0 8px rgba(210, 30, 30, 0.08); }
  30%  { border-color: rgba(210, 30, 30, 0.35); box-shadow: 0 0 5px rgba(210, 30, 30, 0.12); }
  100% { border-color: hsl(var(--border)); box-shadow: none; }
}

/* Boot loader fade out */
@keyframes boot-fade {
  0%, 55%  { opacity: 1; }
  100%     { opacity: 0; }
}

/* Boot text cursor blink */
@keyframes boot-cursor {
  0%, 100% { opacity: 1; }
  50%      { opacity: 0; }
}

/* Watching overlay fade in/out */
@keyframes watch-in {
  from { opacity: 0; transform: translateY(4px); }
  to   { opacity: 1; transform: translateY(0); }
}

/* ── Utility classes ───────────────────────────────────────────────────── */

/* Applied to header for red background pulse */
.animate-red-pulse {
  animation: red-pulse 6s ease-in-out infinite;
}

/* Applied to the banner text for glitch */
.animate-glitch {
  animation: glitch 9s ease-in-out infinite;
}

/* Applied to observer count span */
.animate-count-tick {
  animation: count-tick 4s ease-in-out infinite;
}

/* Terminal typing cursor blink */
@keyframes cursor-blink {
  0%, 49% { opacity: 1; }
  50%, 100% { opacity: 0; }
}

.animate-cursor-blink {
  animation: cursor-blink 0.7s step-start infinite;
}

/* Applied on .post-card:hover → children get jitter */
.post-card:hover .card-title-text {
  animation: text-jitter 0.18s linear infinite;
}

/* Subtle always-on card instability drift */
@keyframes card-drift {
  0%, 100% { transform: translateX(0px) skewX(0deg); }
  33%       { transform: translateX(0.4px) skewX(0.02deg); }
  66%       { transform: translateX(-0.3px) skewX(-0.01deg); }
}

.post-card {
  animation: card-drift 19s ease-in-out infinite;
}
.post-card:nth-child(odd)  { animation-duration: 17s; animation-delay: -6s; }
.post-card:nth-child(even) { animation-duration: 22s; animation-delay: -11s; }

/* Border flash when hovering a post card (keep drift + add flash) */
.post-card:hover {
  animation: card-drift 19s ease-in-out infinite, border-flash-red 1.4s ease-out;
}

/* Scroll distortion: applied by JS when user is scrolling */
.is-scrolling .post-card {
  transform: translateX(0.5px) skewX(0.04deg);
  transition: transform 0.06s ease-out;
  animation: none !important;
}

/* DISSENTER title red blink */
@keyframes dissenter-blink {
  0%, 89%, 92%, 100% { color: inherit; text-shadow: none; }
  90% { color: rgba(220, 40, 40, 0.9); text-shadow: 0 0 10px rgba(220, 40, 40, 0.45); }
  91% { color: inherit; text-shadow: none; }
}

.dissenter-title {
  animation: dissenter-blink 11s ease-in-out infinite;
}

/* [REDACTED] scrolling text */
@keyframes redacted-scroll {
  from { transform: translateX(110vw); }
  to   { transform: translateX(-200%); }
}

/* Footer slow-type cursor */
@keyframes footer-cursor-blink {
  0%, 49% { opacity: 1; }
  50%, 100% { opacity: 0; }
}
.footer-cursor {
  animation: footer-cursor-blink 0.8s step-start infinite;
}

/* Green glow tiers for high-vote posts */
.vote-glow-low {
  box-shadow: 0 0 10px rgba(107, 143, 107, 0.25);
}
.vote-glow-high {
  box-shadow: 0 0 18px rgba(107, 143, 107, 0.45), 0 0 40px rgba(107, 143, 107, 0.15);
}

/* Status dot — active (green) */
.status-dot-active {
  display: inline-block;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background-color: hsl(var(--primary));
  animation: status-pulse 2.5s ease-in-out infinite;
  flex-shrink: 0;
}

/* Status dot — monitored / offline (red) */
.status-dot-monitored {
  display: inline-block;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background-color: rgba(210, 30, 30, 0.9);
  animation: status-pulse 1.2s ease-in-out infinite;
  flex-shrink: 0;
}
